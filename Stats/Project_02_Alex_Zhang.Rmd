---
title: "Project 2"
author: "Alex Zhang"
date: "2022-11-11"
output:
  pdf_document: default
  pdf: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggplot2)
library(pscl)
serengeti <- read.csv("https://sta214-f22.github.io/projects/serengeti.csv")
```
```{r}
logodds_plot <- function(data, num_bins, bin_method,
                         x_name, y_name, grouping = NULL, reg_formula = y ~ x){
  
  if(is.null(grouping)){
    dat <- data.frame(x = data %>% pull(x_name), 
                      y = data %>% pull(y_name),
                      group = 1)
  } else {
    dat <- data.frame(x = data %>% pull(x_name), 
                      y = data %>% pull(y_name),
                      group = data %>% pull(grouping))
  }
  
  if(bin_method == "equal_size"){
    logodds_table <- dat %>%
      drop_na() %>%
      arrange(group, x) %>%
      group_by(group) %>%
      mutate(obs = y,
             bin = rep(1:num_bins,
                       each=ceiling(n()/num_bins))[1:n()]) %>%
      group_by(bin, group) %>%
      summarize(mean_x = mean(x),
                prop = mean(c(obs, 0.5)),
                num_obs = n()) %>%
      ungroup() %>%
      mutate(logodds = log(prop/(1 - prop)))
  } else {
    logodds_table <- dat %>%
      drop_na() %>%
      group_by(group) %>%
      mutate(obs = y,
             bin = cut(x, 
                       breaks = num_bins,
                       labels = F)) %>%
      group_by(bin, group) %>%
      summarize(mean_x = mean(x),
                prop = mean(c(obs, 0.5)),
                num_obs = n()) %>%
      ungroup() %>%
      mutate(logodds = log(prop/(1 - prop)))
  }
  
  if(is.null(grouping)){
    logodds_table %>%
      ggplot(aes(x = mean_x,
                 y = logodds)) +
      geom_point(size=2) +
      geom_smooth(se=F, method="lm", formula = reg_formula) +
      theme_bw() +
      labs(x = x_name,
           y = "Empirical log odds") +
      theme(text = element_text(size=25))
  } else {
    logodds_table %>%
      ggplot(aes(x = mean_x,
                 y = logodds,
                 color = group,
                 shape = group)) +
      geom_point(size=2) +
      geom_smooth(se=F, method="lm", formula = reg_formula) +
      theme_bw() +
      labs(x = x_name,
           y = "Empirical log odds",
           color = grouping,
           shape = grouping) +
      theme(text = element_text(size=25))
  }
  
}
```
```{r}
logmean_plot <- function(data, num_bins, bin_method,
                         x, y, grouping = NULL, reg_formula = y ~ x){
  
  if(is.null(grouping)){
    dat <- data.frame(x = data[,x], 
                      y = data[,y],
                      group = 1)
  } else {
    dat <- data.frame(x = data[,x], 
                      y = data[,y],
                      group = data[,grouping])
  }
  
  if(bin_method == "equal_size"){
    log_table <- dat %>%
      drop_na() %>%
      arrange(group, x) %>%
      group_by(group) %>%
      mutate(obs = y,
             bin = rep(1:num_bins,
                       each=ceiling(n()/num_bins))[1:n()]) %>%
      group_by(bin, group) %>%
      summarize(mean_x = mean(x),
                mean_y = mean(obs),
                num_obs = n()) %>%
      ungroup() %>%
      mutate(log_mean = log(mean_y))
  } else {
    log_table <- dat %>%
      drop_na() %>%
      group_by(group) %>%
      mutate(obs = y,
             bin = cut(x, 
                       breaks = num_bins,
                       labels = F)) %>%
      group_by(bin, group) %>%
      summarize(mean_x = mean(x),
                mean_y = mean(obs),
                num_obs = n()) %>%
      ungroup() %>%
      mutate(log_mean = log(mean_y))
  }
  
  if(is.null(grouping)){
    log_table %>%
      ggplot(aes(x = mean_x,
                 y = log_mean)) +
      geom_point(size=2.5) +
      geom_smooth(se=F, method="lm", formula = reg_formula) +
      theme_bw() +
      labs(x = x,
           y = "Empirical log mean count") +
      theme(text = element_text(size=25))
  } else {
    log_table %>%
      ggplot(aes(x = mean_x,
                 y = log_mean,
                 color = group,
                 shape = group)) +
      geom_point(size=2.5) +
      geom_smooth(se=F, method="lm", formula = reg_formula) +
      theme_bw() +
      labs(x = x,
           y = "Empirical log mean count",
           color = grouping,
           shape = grouping) +
      theme(text = element_text(size=25))
  }
  
}

```



## Abstract


## Section 1: Introduction



## Section 2: Data




```{r}
serengeti <- serengeti %>%
  drop_na()
glimpse(serengeti)
```

After trying to drop the missing data, it still exists 966 rows and 15 columns which indicate there is no missing data. 

Based on the summary of the data, each row it represents the information for a site with specific date. Each row also contains the the count and appearance of certain species and some other environmental factors. There are total 966 rows and 15 columns. The data set contains information about the site id, recorded date, gazalle's count and appearance, topi count, zebra count, and other environmental factors like whether having wildfire or having enough vegetation.

```{r}
ggplot(data = serengeti, aes(x = gazelleThomsons.count)) + geom_histogram(binwidth = 10, fill = "blue") + labs(title = "Figure 2.1", x = "Number of Gazelle", y = "Count")
```
Based on Figure 2.1, we can observe that the number of gazelle Thomsons in these sites ar 0 in most sites. There are also hundreds of gazelle Thomsons in some specific areas.

```{r}
ggplot(data = serengeti, aes(x = topi.count)) + geom_histogram(binwidth = 0.3, fill = "blue") + labs(title = "Figure 2.2", x = "Number of Topi", y = "Count")
```
Based on Figure 2.2, it shows that in most recorded sites, the number of topi is 0 and there are few of them in some specific sites.


```{r}
ggplot(data = serengeti, aes(x = zebra.count)) + geom_histogram(binwidth = 10, fill = "blue") + labs(title = "Figure 2.3", x = "Number of Zebra", y = "Count")
```

Based on Figure 2.3, we can also conclude that the number of zebra in most sites is 0.




```{r}
logmean_plot(data = serengeti, 60, "equal_size","ndvi", "topi.count", reg_formula = y ~ x) + labs(title = "Figure 2.4", x = "NDVI")
```

As showed from Figure 2.4, the relationship between the number of topi and the vegetation condition is also linear since points are bouncing around the linear which means no transformation needed.


```{r}
logmean_plot(data = serengeti, 60, "equal_size","ndvi", "zebra.count", reg_formula = y ~ poly(x,2)) + labs(title = "Figure 2.5", x = "NDVI")
```
Based on Figure 2.5, the relationship between the number of zebra and the vegetation condition is nonlinear. So the polynomial transformation with a power of two is needed.



```{r}
logmean_plot(data = serengeti, 60, "equal_size","ndvi", "gazelleThomsons.count", reg_formula = y ~ x) + labs(title = "Figure 2.6", x = "NDVI")
```

Based on Figure 2.6, the relationship between vegetation condition and the number of gazelle can be defined as linear since there is no explicit shape. No transformation is required.

```{r}
logmean_plot(data = serengeti, 60, "equal_size",x = "amRivDist",  y = "topi.count", reg_formula = y ~ (x)) + labs(title = "Figure 2.7", x = "River Distance")
```

Based on Figure 2.7, ideally no transformation is needed for the relation between river distance and the number of topi. However, since the numbers for river distance are really large, outweighted other variablers, I choose to do the log transformation on it.



```{r}
logmean_plot(data = serengeti, 60, "equal_size",x = "amRivDist",  y = "zebra.count", reg_formula = y ~ x) + labs(title = "Figure 2.8", x = "River Distance")
```

As Figure 2.8 shows, it is also reasonable to have a log transformation with the same reason for the relation between river distance and the number of topi.




```{r}
logmean_plot(data = serengeti, 60, "equal_size", x = "amRivDist", y = "gazelleThomsons.count", reg_formula = y ~ (x)) +  labs(title = "Figure 2.9", x = "River Distance")
```

Based on Figure 2.9, having a log transformation is reasonable for the relation between the number of gazelle and the river distance.

```{r}
logmean_plot(data = serengeti, 60, "equal_size", x = "TM100", y = "topi.count", reg_formula = y ~ x) + labs(title = "Figure 2.10", x = "Number of Termite Mound")
```

Based on Figure 2.10, no transformation is needed since it is hard to describe the shape.


```{r}
logmean_plot(data = serengeti, 60, "equal_size", x = "TM100", y = "zebra.count", reg_formula = y ~ x) + labs(title = "Figure 2.11", x = "Number of Termite Mound")
```

Based on Figure 2.11, there is also no transformation needed for the relationship between the number of zebra and the number of termite mounds since most of the points is about around the line.


```{r}
logmean_plot(data = serengeti, 60, "equal_size", x = "TM100", y = "gazelleThomsons.count", reg_formula = y ~ x) + labs(title = "Figure 2.12", x = "Number of Termite Mound")
```

Based on the Figure 2.12, the relation between number of termite and the number of gazelle does not need to do any transformation.


```{r}
logmean_plot(data = serengeti, 60, "equal_size", x = "T50", y = "topi.count", reg_formula = y ~ x) + labs(title = "Figure 2.13", x = "Number of Trees")
```

Based on the Figure 2.13, there is no transformation needed for the number of trees and the number of topi.

```{r}
logmean_plot(data = serengeti, 60, "equal_size", x = "T50", y = "zebra.count", reg_formula = y ~ x)  + labs(title = "Figure 2.14", x = "Number of Trees")
```

Based on Figure 2.14,  no transformation is required for the number of trees and number of zebra. 

```{r}
logmean_plot(data = serengeti, 60, "equal_size", x = "T50", y = "gazelleThomsons.count", reg_formula = y ~ x)   + labs(title = "Figure 2.15", x = "Number of Trees")
```

As Figure 2.15 shows, only doing linear transformation for the relationship between number of gazelle and number treesis fine.


```{r}
logmean_plot(data = serengeti, 60, "equal_size", x = "LriskDry", y = "topi.count", reg_formula = y ~ x)  + labs(title = "Figure 2.16", x = "Risky to Lion")
```

As shown in Figure 2.16, it is reasonable to not have any transformation between the risk to lion and the number of topi.

```{r}
logmean_plot(data = serengeti, 60, "equal_size", x = "LriskDry", y = "zebra.count", reg_formula = y ~ (x))  + labs(title = "Figure 2.17", x = "Risky to Lion")
```

Based on Figure 2.17, no transformation is needed for the relationship between the number of zebra and the risk to lion in certain site.

```{r}
logmean_plot(data = serengeti, 60, "equal_size", x = "LriskDry", y = "gazelleThomsons.count", reg_formula = y ~ (x)) +   labs(title = "Figure 2.18", x = "Risky to Lion")
```

From the Figure 2.18, it shows that just having linear transformation for the relation between the risk to lion and number of gazelle.

```{r}
serengeti <- serengeti %>%
  mutate(fire = as.factor(fire))
ggplot(data = serengeti, aes(x = fire)) + geom_bar(fill = "blue") + labs(title = "Figure 2.19", x = "Whether has fire")
```

Based on Figure 2.19, the $fire$ variable is very discrete and there is only one row showing that there is a wild fire. So this variable will not be chosen to include in the models since there is rarely relation between the number of species and whether has a wild fire.


## Section 3: Modeling

In the modeling section, since based on the Figure 2.1, 2.2, and 2.3 showed, three ZIP models for each species are required since there are excessive number of 0 in each species counts.


### Section 3.1: Importance of enviornment variables
For three different species, the population model will be the same. The population model for logistic regression part will be:
$$Z_i \sim Bernoulli(\alpha_i)$$
$$\log \left ( \frac{\alpha_i}{1-\alpha_i} \right ) = \gamma_0 + \gamma_1ndvi_i + \gamma_2log(amRivDist_i) + \gamma_3TM100_i + \gamma_4LriskDry_i + \gamma_5T50_i$$

The Poisson part will be:
$$Y_i \sim Poisson(\lambda_i)$$

$$\log \left( \lambda_i \right) = \beta_0 + \beta_1ndvi_i + \beta_2log(amRivDist_i) + \beta_3TM100_i + \beta_4LriskDry_i + \beta_5T50_i$$

For specie topi, the summary for fitted regression model will be:
```{r}
zip_m1 <- zeroinfl(topi.count ~ ndvi + log(amRivDist) + TM100 + LriskDry + T50 | ndvi  + log(amRivDist) + TM100 + LriskDry + T50 , data = serengeti)
summary(zip_m1)
```

Based on the summary, the fitted regression line for topi will be:
$$\log \left ( \frac{\alpha_i}{1-\alpha_i} \right ) = 1.889 - 1.252ndvi_i + 0.241log(amRivDist_i) -0.0227 TM100_i -154.3riskDry_i - 0.0011T50_i$$
$$\log \left( \lambda_i \right) = 1.779 -0.241ndvi_i -0.152log(amRivDist_i) -0.204TM100_i +  62.511LriskDry_i +0.0006T50_i$$


Based on the fitted line, we predict that with one unit increase in ndvi, the log mean number of topi will decrease by 0.241. With one unit increase in log river distance, we predict that the log mean for topi count will decrease by 0.152. With one unit increase in termite mound, we predict that the log mean topi will decrease by 0.204. With one unit increase risky to lion, we predict that the log mean topi count will increase by 62.511. With on unit increases in T50, we predict that the log topi number mean will increase by 0.0006. All the interpretations are done when other variables holding constant.




The summary for the fitted regression line for zebra will be:
```{r}
zip_m2 <- zeroinfl(zebra.count ~ poly(ndvi,2) + log(amRivDist) + TM100 + LriskDry + T50 | poly(ndvi,2) + log(amRivDist) + TM100 + LriskDry + T50, data = serengeti)
summary(zip_m2)
```

For specie zebra, the fitted regression line will be:
$$\log \left ( \frac{\alpha_i}{1-\alpha_i} \right ) = 0.127 + 2.4925ndvi_i + 19.34ndvi_i^2 + 0.0663log(amRivDist_i) + 0.26TM100_i + 83.7532LriskDry_i -0.0009T50_i$$
$$\log \left( \lambda_i \right) =2.426 - 8.638ndvi_i - 21.32ndvi_i^2 -0.0051log(amRivDist_i) -0.1599TM100_i - 37.82LriskDry_i + 0.0004T50_i$$
From the fitted regression line, we predict that with one unit increase in log(amRivDist), the expected log mean for zebra will decrease by 0.0051. With on unit increase in Tm100, we predict that the log mean for zebra number will decrease by 0.1599. With one unit increase in LriskDry, we predict that the log mean zebra number will decrease by 37.82. With one unit increase in T50, we predict that the log mean for zebra number will increase by 0.0004.





The summary fitted regression model for specie gazelle will be:
```{r}
zip_m3 <- zeroinfl(gazelleThomsons.count ~ ndvi + log(amRivDist) + TM100 + LriskDry + T50  | ndvi + log(amRivDist) + TM100 + LriskDry + T50, data = serengeti)
summary(zip_m3)
```


The fitted regression line for gazelle will be:
$$\log \left ( \frac{\alpha_i}{1-\alpha_i} \right ) = 0.5805 + 5.235ndvi_i - 0.1815log(amRivDist_i) + 0.6865TM100_i + 43.7LriskDry_i + 0.00003T50_i$$
$$\log \left( \lambda_i \right) = -0.0422 -2.816ndvi_i + 0.5595log(amRivDist_i) -0.3943TM100_i - 102.3LriskDry_i - 0.0026T50_i$$


Based on the fitted regression line, with one unit increase in the ndvi, we predict that the log mean for gazelle's count will decrease by 2.816. With one unit increase in log(amRivDist), we predict that the log mean for the number of gazelle will increase by 0.5595. With one unit increase in TM100, we predict that the log mean for gazelle count will decrease by 0.3943. With one unit increase in LriskDry, we predict that the log mean of gazelle number will decrease by 102.3. With one unit increase in number of trees, we predict that the log mean number of gazelle will decrease by 0.0026. With other variables holding constant.





With the given research question, I will first test whether environmental variables have relationship with the number of topi in data set.
Basically, I decided to do the hypothesis test for variables "ndvi", "TM100", and "T50" together since the measurement on how "green" the location is related to the number of trees in location and also relates to the soil quality about termite mounds. I also will give separate test for the rest to variables for each different species.


### Topi



#### Test 1
The first test is testing whether there is a relation between the vegetation condition (ndvi), number of trees (T50), and the number of termite mound (TM100) and topi count.
The hypothesis test will be


$H_0: \beta_1 = \beta_3 = \beta_5 = 0$


$H_a: \text{At least one of the } \beta \text{ are not zero}$



The log likelihood for the full model will be:
```{r}
zip_m1$loglik
```

The log likelihood for the reduced model will be:
```{r}
zip_m1_re <- zeroinfl(topi.count ~ log(amRivDist) + LriskDry   | ndvi + log(amRivDist) + TM100 + LriskDry + T50, data = serengeti)
zip_m1_re$loglik
```
The test statistic $G$ will be $2(-355.7883-(-356.9112)) = 2.2458 $

Using $\chi^2$ distribution, the p-value will be
```{r}
pchisq(2.2458, df = 3, lower.tail = FALSE)
```
Since the p-value is very close to 0, we can conclude that we there is a strong relationship between the topi count and the vegetation condition (ndvi), number of trees (T50), and the number of termite mound (TM100).


#### Test 2
The second hypothesis test is testing whether there is a relationship between the number of topi and the log of river distance (log(amRivDist)).
The hypothesis test will be:


$H_0: \beta_2 = 0$


$H_a: \beta_2 \neq 0$

The log likelihood for the full model will be:
```{r}
zip_m1$loglik
```

The log likelihood for the reduced model will be:
```{r}
zip_m1_re2 <- zeroinfl(topi.count ~ ndvi + TM100 + LriskDry + T50  | ndvi + log(amRivDist) + TM100 + LriskDry + T50, data = serengeti)
zip_m1_re2$loglik
```

The test statistic $G$ will be $2(-355.7883-(-357.0991)) = 2.2458 $

Using $\chi^2$ distribution, the p-value will be
```{r}
pchisq(2.6216, df = 1, lower.tail = FALSE)
```

Since p-value is relative small, we can conclude that there is a moderate relationship between the number of topi and the log river distance over each site.

#### Test 3

The third hypothesis test is testing whether there is a relationship between the number of topi and the risky to lions.
The hypothesis test will be:

$H_0: \beta_4 = 0$


$H_a: \beta_4 \neq 0$

The log likelihood for the full model will be:
```{r}
zip_m1$loglik
```

The log likelihood for the reduced model will be:
```{r}
zip_m1_re3 <- zeroinfl(topi.count ~ ndvi + log(amRivDist) + TM100  + T50  | ndvi + log(amRivDist) + TM100 + LriskDry + T50, data = serengeti)
zip_m1_re3$loglik
```

The test statistic $G$ will be $2(-355.7883-(-356.8398))  2.103 $

Using $\chi^2$ distribution, the p-value will be
```{r}
pchisq(2.103, df = 1, lower.tail = FALSE)
```

Since p-value is relative small, we can conclude that there is a moderate relationship between the number of topi and the risky to lions with these sites.



### Zebra

#### Test 1
Same as the tests in topi count, the first hypothesis test on zebra will be testing the relationship between the number of zebra and the vegetation condition (ndvi), number of trees (T50).
The hypothesis test will be:

$H_0: \beta_1 =\beta_2 = \beta_4 = \beta_6 = 0$


$H_a: \text{At least one of the } \beta \text{ are not zero}$

The log likelihood for the full model will be:
```{r}
zip_m2$loglik
```

The log likelihood for the reduced model will be:
```{r}
zip_m2_re <- zeroinfl(zebra.count ~ log(amRivDist) +LriskDry  | poly(ndvi,2) + log(amRivDist) + TM100 + LriskDry + T50, data = serengeti)
zip_m2_re$loglik
```

The test statistic $G$ will be $2(-5376.208-(-5786.12)) = 819.824 $

Using $\chi^2$ distribution, the p-value will be
```{r}
pchisq(819.824, df = 4, lower.tail = FALSE)
```

Since this p-value is very close to zero, we can conclude that there is a strong relationship between the number of zebra and vegetation condition (ndvi), number of trees (T50), and the number of termite mound (TM100) in this data set.


#### Test 2


The second hypothesis test on zebra will be testing the relationship between the number of zebra and the log of the river distance (log(amRivDist)).
The hypothesis test will be:

$H_0: \beta_2 = 0$


$H_a: \beta_2 \neq 0$

The log likelihood for the full model will be:
```{r}
zip_m2$loglik
```

The log likelihood for the reduced model will be:
```{r}
zip_m2_re2 <- zeroinfl(zebra.count~poly(ndvi,2) + TM100+ T50 +LriskDry  | poly(ndvi,2) + log(amRivDist) + TM100 + LriskDry + T50, data = serengeti)
zip_m2_re2$loglik
```

The test statistic $G$ will be $2(-5376.208-(-5376.331)) = 0.246 $

Using $\chi^2$ distribution, the p-value will be
```{r}
pchisq(0.246, df = 1, lower.tail = FALSE)
```

Based on the result, the p-value is relatively large, we can conclude that there is a weak or even no relation between the number of zebra and the log river distance in this data set.



#### Test 3


The third hypothesis test on zebra will be testing the relationship between the number of zebra and the risky to lions (LriskDry)
The hypothesis test will be:

$H_0: \beta_6 = 0$


$H_a: \beta_6 \neq 0$

The log likelihood for the full model will be:
```{r}
zip_m2$loglik
```

The log likelihood for the reduced model will be:
```{r}
zip_m2_re3 <- zeroinfl(zebra.count~poly(ndvi,2) + TM100+ T50  + log(amRivDist)  | poly(ndvi,2) + log(amRivDist) + TM100 + LriskDry + T50, data = serengeti)
zip_m2_re3$loglik
```

The test statistic $G$ will be $2(-5376.208-( -5386.361)) = 20.306 $

Using $\chi^2$ distribution, the p-value will be
```{r}
pchisq(20.306, df = 1, lower.tail = FALSE)
```

From the result, the p-value is kind of close to zero. We can conclude that there is a strong relationship between the number of zebra in sites and the risky to lions.



### Gazelle

#### Test 1
The first test is testing whether there is a relation between the vegetation condition (ndvi), number of trees (T50), and the number of termite mound (TM100) and number of gazelles.
The hypothesis test will be


$H_0: \beta_1 = \beta_3 = \beta_5 = 0$


$H_a: \text{At least one of the } \beta \text{ are not zero}$



The log likelihood for the full model will be:
```{r}
zip_m3$loglik
```

The log likelihood for the reduced model will be:
```{r}
zip_m3_re <- zeroinfl(gazelleThomsons.count ~ log(amRivDist) + LriskDry   | ndvi + log(amRivDist) + TM100 + LriskDry + T50, data = serengeti)
zip_m3_re$loglik
```
The test statistic $G$ will be $2(-2963.71 -(-3196.036)) = 464.652 $

Using $\chi^2$ distribution, the p-value will be
```{r}
pchisq(464.652, df = 3, lower.tail = FALSE)
```
Based on the result, the p-value is very close to zero. We can conclude that there is a strong relationship between the number of gazelle and the vegetation condition, number of trees and the termite mound.


#### Test 2
The second test is testing whether there is a relation between the number of gazelle and the log of river distance (log(amRivDist)).
The hypothesis test will be:


$H_0: \beta_2 = 0$


$H_a: \beta_2 \neq 0$



The log likelihood for the full model will be:
```{r}
zip_m3$loglik
```

The log likelihood for the reduced model will be:
```{r}
zip_m3_re2 <- zeroinfl(gazelleThomsons.count ~ ndvi + TM100 + T50 + LriskDry   | ndvi + log(amRivDist) + TM100 + LriskDry + T50, data = serengeti)
zip_m3_re2$loglik
```
The test statistic $G$ will be $2(-2963.71 -(-3290.404)) = 653.388 $

Using $\chi^2$ distribution, the p-value will be
```{r}
pchisq(653.388, df = 1, lower.tail = FALSE)
```
Based on the result, the p-value is very close to zero. We can conclude that there is a strong relationship between the number of gazelle and the log of river distance.

#### Test 3
The third test is testing whether there is a relation between the number of gazelle and the risky to lions (LriskDry).
The hypothesis test will be:


$H_0: \beta_5 = 0$


$H_a: \beta_5 \neq 0$



The log likelihood for the full model will be:
```{r}
zip_m3$loglik
```

The log likelihood for the reduced model will be:
```{r}
zip_m3_re3 <- zeroinfl(gazelleThomsons.count ~ ndvi + TM100 + T50 +log(amRivDist)   | ndvi + log(amRivDist) + TM100 + LriskDry + T50, data = serengeti)
zip_m3_re3$loglik
```
The test statistic $G$ will be $2(-2963.71 -(-3008.449)) = 89.478 $

Using $\chi^2$ distribution, the p-value will be
```{r}
pchisq(89.478, df = 1, lower.tail = FALSE)
```
Based on the result, the p-value is very close to zero. We can conclude that there is a strong relationship between the number of gazelle and the risky to lion.



### Section 3.2: Comparing species









## Section 4: Discussion



